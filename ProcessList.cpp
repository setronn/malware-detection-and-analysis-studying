#include <windows.h>
#include <tlhelp32.h>
#include <tchar.h>
#include <stdio.h>

void GetProcessList()
{
    HANDLE hProcessSnap;
    HANDLE hProcess;
    PROCESSENTRY32 pe32;

    hProcessSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
    pe32.dwSize = sizeof(PROCESSENTRY32);

    while (Process32Next(hProcessSnap, &pe32))
    {
        _tprintf(TEXT("Name: %s"), pe32.szExeFile);
        _tprintf(TEXT(", ID = %d"), pe32.th32ProcessID);
        _tprintf(TEXT(", Threads = %d"), pe32.cntThreads);
        _tprintf(TEXT(", Parent = %d \n"), pe32.th32ParentProcessID);
    }
    CloseHandle(hProcessSnap);
}

int main( void )
{
  GetProcessList();
  getchar();
}
